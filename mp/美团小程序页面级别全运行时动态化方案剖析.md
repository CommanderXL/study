## 美团小程序页面级别全运行时动态化方案剖析

小程序整体还是编译+运行时混合的方案。

美团团购（Caster 动态容器）运行时方案，模拟浏览器环境中集成了 Kbone 来作为 DOM/BOM 的补充实现。

美团外卖（Tango 动态容器）运行时方案，使用 React-reconciler 来作为 DOM/BOM 的补充实现（和 Taro 的方案基本类似）。

在由 VNode -> 视图渲染这一环节，**所有的小程序运行时方案基本都一致**：template + custom-component 的递归渲染方式，由 VNode 去驱动视图最终的渲染。

动态化的基座：可以理解为基础模板。 -> 和原生小程序的集成

页面渲染流程：

`DD` 存储平台， `Portm` 动态数据分发平台，所以数据结构一致：

```javascript
Interface API {
  dom: object
  jscode: array
  json: unknow
  wxs_mode: array
  style: array
  snap: string
  dep: Record<string, DD>
  hash: string
  expire: num
}

Interface Dom {
  tag: string
  attr: object
  children: Array<Dom>
  template?: object
  wxs?: object
}
```

Tango：

> https://portal-portm.meituan.com/weapp/dynamic/v6/pay-finance-cashier__3.1.4__gray/cashier-page


Caster：

> https://portal-portm.meituan.com/weapp/dynamic/v6/meituanpaotui__2.61.2__prod/pages-index-index


* [美团外卖终端容器无关化研发框架](https://tech.meituan.com/2021/11/11/meituan-waimai-containerless-framework.html)
